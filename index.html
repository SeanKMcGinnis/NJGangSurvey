 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=7,IE=9" />
    <!--The viewport meta tag is used to improve the presentation and behavior of the samples on iOS devices-->
    <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no"/>
    <title>New Jersey - 2010 Gang Survey</title>
    <link rel="stylesheet" type="text/css" href="http://serverapi.arcgisonline.com/jsapi/arcgis/3.1/js/dojo/dijit/themes/nihilo/nihilo.css">
    <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:600italic|Prata' rel='stylesheet' type='text/css'>
    <link href="lib/css/map.css" rel="stylesheet" type="text/css">
    <link href="lib/css/page.css" rel="stylesheet" type="text/css">
    <script type="text/javascript">
	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-35418985-1']);
	  _gaq.push(['_trackPageview']);
	
	  (function() {
	    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();
	</script>
  </head>
  <body class="nihilo">
  	<div id="dialogGang" dojoType="dijit.Dialog" title="Gang Summary" autofocus="false" style="display:none;border:ridge;border-width: thick;width:800px;height:600px; min-height:600px;min-width: 800px; " draggable="false" >
    	<div id="tabGangs" dojotype="dijit.layout.TabContainer" style="width: 780px; height:550px;" tabPosition="left-h" data-dojo-props="trim:false"></div>        
    </div>
    <div id="dialogTown" dojoType="dijit.Dialog" autofocus="false" style="display:none;border:ridge;border-width: thick;width:800px;height:650px; min-height:650px;min-width: 800px; " draggable="false" >
		<div id="bcTown" dojotype="dijit.layout.BorderContainer" style="width:780px; height:650px" gutters="false">
			<div dojotype="dijit.layout.ContentPane" region="left" style="width:390px; height:210px">
				<div class="header">General Gang Information</div>
				Gang Awareness Training: <span id="GANGAWARE"></span><br />
				Problem Gang:<span id="ProbGang"></span><br />
				Actively Recruiting:<span id="ActGang"></span><br />
				Incarceration Control:<span id="IncarCtrl"></span><br />
				Jail Recruiting:<span id="JailRcrt"></span><br />
				Extreme Ideologies:<span id="Ideology"></span><br/>
				Extremist Connections:<span id="ExtConn"></span><br/>
				Criminal Network:<span id="CrimNet"></span><br/>
				Activity Change:<span id="ActChange"></span><br>
				
			</div>
			<div dojotype="dijit.layout.ContentPane" region="center" style="height:210px">
				<div class="header">Crimes in Schools</div>
				School Incidents:<span id="SchInc"></span><br>
				Incident Count:<span id="SchIncCnt"></span><br>
				Station House:<span id="StaHouse"></span><br />
				SAP Referer:<span id="SAP_Refer"></span><br>
				Gang Education:<span id="GangEd"></span><br>
				School Truancy:<span id="SchTru"></span><br>
				School Presence:<span id="SchPres"></span><br>
				<!--div class="header">Gangs in Schools</div>
				<ul id="gang-list"></ul-->
			</div>
			<div dojotype="dijit.layout.ContentPane" region="bottom" style="height:425px">
				<div class="header">Frequency of Incidents at Schools</div>
				<table class="school-incident">
					<thead>
					<tr>
						<th class="description"></th>
						<th>Never</th>
						<th>Don't Know</th>
						<th>Rarely</th>
						<th>Occasionally</th>
						<th>Frequently</th>
						<th>N/A</th>
					</tr>
					</thead>
					<tr class="odd">
						<td class="school-incident" align="right">Vandalism</td>
						<td id="vandal-never" class="school-incident"></td>
						<td id="vandal-dk" class="school-incident"></td>
						<td id="vandal-rare" class="school-incident"></td>
						<td id="vandal-occ" class="school-incident"></td>
						<td id="vandal-freq" class="school-incident"></td>
						<td id="vandal-na" class="school-incident"></td>
					</tr>
					<tr>
						<td align="right" class="school-incident">Theft</td>
						<td id="theft-never" class="school-incident"></td>
						<td id="theft-dk" class="school-incident"></td>
						<td id="theft-rare" class="school-incident"></td>
						<td id="theft-occ" class="school-incident"></td>
						<td id="theft-freq" class="school-incident"></td>
						<td id="theft-na" class="school-incident"></td>
					</tr>
					<tr class="odd">
						<td align="right">Extortion</td>
						<td id="extort-never" class="school-incident"></td>
						<td id="extort-dk" class="school-incident"></td>
						<td id="extort-rare" class="school-incident"></td>
						<td id="extort-occ" class="school-incident"></td>
						<td id="extort-freq" class="school-incident"></td>
						<td id="extort-na" class="school-incident"></td>
					</tr>
					<tr>
						<td align="right">Assault</td>
						<td id="assault-never" class="school-incident"></td>
						<td id="assault-dk" class="school-incident"></td>
						<td id="assault-rare" class="school-incident"></td>
						<td id="assault-occ" class="school-incident"></td>
						<td id="assault-freq" class="school-incident"></td>
						<td id="assault-na" class="school-incident"></td>
					</tr>
					<tr class="odd">
						<td align="right">Agg. Assault</td>
						<td id="aggasslt-never" class="school-incident"></td>
						<td id="aggasslt-dk" class="school-incident"></td>
						<td id="aggasslt-rare" class="school-incident"></td>
						<td id="aggasslt-occ" class="school-incident"></td>
						<td id="aggasslt-freq" class="school-incident"></td>
						<td id="aggasslt-na" class="school-incident"></td>
					</tr>
					<tr>
						<td align="right">Homicide</td>
						<td id="homicide-never" class="school-incident"></td>
						<td id="homicide-dk" class="school-incident"></td>
						<td id="homicide-rare" class="school-incident"></td>
						<td id="homicide-occ" class="school-incident"></td>
						<td id="homicide-freq" class="school-incident"></td>
						<td id="homicide-na" class="school-incident"></td>
					</tr>
					<tr class="odd">
						<td align="right">Att. Homicide</td>
						<td id="atthom-never" class="school-incident"></td>
						<td id="atthom-dk" class="school-incident"></td>
						<td id="atthom-rare" class="school-incident"></td>
						<td id="atthom-occ" class="school-incident"></td>
						<td id="atthom-freq" class="school-incident"></td>
						<td id="atthom-na" class="school-incident"></td>
					</tr>
					<tr>
						<td align="right">Narcotics</td>
						<td class="school-incident" id="narcotics-never"></td>
						<td id="narcotics-dk" class="school-incident"></td>
						<td id="narcotics-rare" class="school-incident"></td>
						<td id="narcotics-occ" class="school-incident"></td>
						<td id="narcotics-freq" class="school-incident"></td>
						<td id="narcotics-na" class="school-incident"></td>
					</tr>
					<tr class="odd">
						<td align="right">Weapons</td>
						<td id="weapons-never" class="school-incident"></td>
						<td id="weapons-dk" class="school-incident"></td>
						<td id="weapons-rare" class="school-incident"></td>
						<td id="weapons-occ" class="school-incident"></td>
						<td id="weapons-freq" class="school-incident"></td>
						<td id="weapons-na" class="school-incident"></td>
					</tr>
					<tr>
						<td align="right">Trespassing</td>
						<td id="trespass-never" class="school-incident"></td>
						<td id="trespass-dk" class="school-incident"></td>
						<td id="trespass-rare" class="school-incident"></td>
						<td id="trespass-occ" class="school-incident"></td>
						<td id="trespass-freq" class="school-incident"></td>
						<td id="trespass-na" class="school-incident"></td>
					</tr>
					<tr class="odd">
						<td align="right">Gang Recruiting</td>
						<td id="recruit-never" class="school-incident"></td>
						<td id="recruit-dk" class="school-incident"></td>
						<td id="recruit-rare" class="school-incident"></td>
						<td id="recruit-occ" class="school-incident"></td>
						<td id="recruit-freq" class="school-incident"></td>
						<td id="recruit-na" class="school-incident"></td>
					</tr>
					<tr>
						<td align="right">Gang Signs</td>
						<td id="gangsign-never" class="school-incident"></td>
						<td id="gangsign-dk" class="school-incident"></td>
						<td id="gangsign-rare" class="school-incident"></td>
						<td id="gangsign-occ" class="school-incident"></td>
						<td id="gangsign-freq" class="school-incident"></td>
						<td id="gangsign-na" class="school-incident"></td>
					</tr>
				</table>
			</div>
		</div>      
    </div>
    <div id="bordercontainer" dojotype="dijit.layout.BorderContainer" style="width:100%; height:100%;" design="headline" gutters="false" >
    	<div id="mapDiv" dojotype="dijit.layout.ContentPane" region="center" ></div>
    	<div id="pane-details" dojotype="dijit.layout.BorderContainer" region="right" gutters="false">
    		<div id="footer" dojotype="dijit.layout.ContentPane" region="top">
    			2010 New Jersey Gang Survey
    		</div>
    		<div dojotype="dijit.layout.ContentPane" region="center">
    			<div id="welcome-pane">
    			<dl>
    				<dt>
    					About this application
    				</dt>
    				<dd>
    					The <a href="http://www.njsp.org/" target="_blank">New Jersey State Police</a> has compiled triennial gang surveys since 2001, the <a href="http://www.njgangsurvey.com" 
    					target="_blank">most recent survey was released in 2010</a>. For the first time in the survey's history, the 2010 survey
						collected for all 566 municipalities in the State of New Jersey. The original data can be downloaded
						from the <a href="http://njgangsurvey.com/links.aspx" target="_blank">NJ Gang Survey</a>.
    				</dd>
    				<dt>Using the Map</dt>
    				<dd>
    					The map shows towns classified as <span class="red strong">Red</span> or <span class="green strong">Green</span>. The towns in
						<span class="red strong">Red</span> have one or more active gangs. When clicking on one of the towns, information will displayed
						to identify whether the gangs celebrate a major anniversary, congregate in the parks, attend a major event in the town or are in
						the school system. Town specific information about the gang activity in the town or details about the individual gangs can be
						found by clicking on the report card links. 
    				</dd>
    				<dt>Technology</dt>
    				<dd>
    					The information displayed in the application is coming from a couple different places:<br />
    					<a href="http://www.arcgis.com/about/" target="blank">ArcGIS Online</a> - the spatial data is coming from a hosted feature service.<br />
    					<a href="http://www.google.com/fusiontables" target="_blank">Google Fusion Tables</a> - gang specific survey information is being queried from a shared Fusion Table
    				</dd>
    				
    			</dl>
    		</div>
    		<div id="gang-results" class="hidden">
    			<div><a href="javascript:showDetailPane()" style="right:0">Project Details</a></div>
    			<dl>
    				<dt id="municipality_name" class="town-name"></dt>
    				<dd>
    					<div id="county-name"></div>
    					<div id="population"></div>
    				</dd>
    			</dl>
    			<div id="gang-activity" ><img id="img-gang-activity" class="middle">&nbsp;<span class="list-item" >Gang Activity</span></div>
				<div id="gang-anniversary"><img id="img-gang-anniversary" class="middle">&nbsp;<span class="list-item">Gang Anniversary</span></div>
				<div id="gang-congregate"><img id="img-gang-congregate" class="middle">&nbsp;<span class="list-item">Gangs Congregating in Parks</span></div>
				<div id="gang-event"><img id="img-gang-event" class="middle">&nbsp;<span class="list-item">Major Events Gangs Attend</span></div>
				<div id="gang-schools"><img id="img-gang-schools" class="middle">&nbsp;<span class="list-item">Gangs in schools</span></div>
    			<dl>
    				<dt>Report Cards</dt>
    				<dd id="town-report-card"></dd>
    				<dt>Understanding the Responses</dt>
    				<dd class="demo-yes">
    					<img src="lib/images/bullet-red.png" class="middle" />Activity or event occurs in the town 
    				</dd>
    				<dd class="demo-no">
    					<img src="lib/images/bullet-green.png" class="middle" />Activity or event is not occurring in town 
    				</dd>
    				<dd class="demo-maybe">
    					<img src="lib/images/bullet-grey.png" class="middle"  />No reponse or it wasn't applicable 
    				</dd>
    			</dl>    		</div>    		</div>    	</div>    </div>  </body>
  <script type="text/javascript">
      var djConfig = {
        parseOnLoad: true
      };
  </script>
  <script type="text/javascript" src="http://serverapi.arcgisonline.com/jsapi/arcgis/?v=3.1"></script>
  <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script type="text/javascript">
      google.load('visualization', '1', {packages: ['imagepiechart']});
    </script>
  <script type="text/javascript" src="lib/js/pageComponents.js"></script>
  <script type="text/javascript" src="lib/js/gangID.js"></script>
  <script type="text/javascript" src="lib/js/reportCard.js"></script>
  <script type="text/javascript" src="lib/js/gangReport.js"></script>
  <script type="text/javascript">
    dojo.require("dijit.dijit");
    dojo.require("dijit.Dialog");dojo.require("dijit.form.Button");
    dojo.require("dijit.form.CheckBox");
    dojo.require("dijit.layout.BorderContainer");
    dojo.require("dijit.layout.ContentPane");
    dojo.require("dijit.layout.TabContainer");
    dojo.require("dojox.charting.Chart2D");
    dojo.require("esri.map");
    dojo.require("esri.layers.FeatureLayer");
    dojo.require("esri.layers.graphics");
    dojo.require("esri.tasks.query");
    dojo.require("dojo.number");
    var map;
    var dialog;
    var gangLayer;
    var gLayer;
    var townCode;
    var gangDetails = false;
    function init() {
        var levelOfDetail = [
            {"level" : 0, "resolution" : 3472.22222222222, "scale" : 4000000},
            {"level" : 1, "resolution" : 2604.16666666667, "scale" : 3000000},
            {"level" : 2, "resolution" : 2170.13888888889, "scale" : 2500000},
            {"level" : 3, "resolution" : 1562.5, "scale" : 1800000},
            {"level" : 4, "resolution" : 976.5625, "scale" : 1125000},
            {"level" : 5, "resolution" : 494.791666666667, "scale" : 570000},
            {"level" : 6, "resolution" : 260.416666666667, "scale" : 300000},
            {"level" : 7, "resolution" : 130.208333333333, "scale" : 150000},
            {"level" : 8, "resolution" : 65.1041666666667, "scale" : 75000},
            {"level" : 9, "resolution" : 32.5520833333333, "scale" : 37500},
            {"level" : 10, "resolution" : 21.7013888888889, "scale" : 25000},
            {"level" : 11, "resolution" : 10.8506944444444, "scale" : 12500},
            {"level" : 12, "resolution" : 5.20833333333333, "scale" : 6000},
            {"level" : 13, "resolution" : 2.08333333333333, "scale" : 2400},
            {"level" : 14, "resolution" : 1.04166666666667, "scale" : 1200},
          ];
        var initialExtent = new esri.geometry.Extent({
            "xmin": 170000,
            "ymin": 10000,
            "xmax":  707125,
            "ymax": 975000,
            "spatialReference": {"wkid": 3424}
            }); 
        //create map
        map = new esri.Map("mapDiv",{extent:initialExtent,lods:levelOfDetail});
        //create and add new layer
        var layer = new esri.layers.ArcGISTiledMapServiceLayer("http://njgin.state.nj.us/ArcGIS/rest/services/Basemap/bottom/MapServer");
        map.addLayer(layer);
        gangLayer = new esri.layers.FeatureLayer("http://services1.arcgis.com/ZcxtvO7wNR3U7VWZ/arcgis/rest/services/2010_New_Jersey_Gang_Survey/FeatureServer/0",{
            mode: esri.layers.FeatureLayer.MODE_ONDEMAND,
            outFields: ["*"]
          });
        var defaultSymbol = new esri.symbol.SimpleFillSymbol().setStyle(esri.symbol.SimpleFillSymbol.STYLE_NULL, new dojo.Color([80,80,80]), .5);
        defaultSymbol.outline.setStyle(esri.symbol.SimpleLineSymbol.STYLE_NULL);
        var renderer = new esri.renderer.UniqueValueRenderer(defaultSymbol, "GANGPRES");
        renderer.addValue("Yes", new esri.symbol.SimpleFillSymbol().setColor(new dojo.Color([255, 132, 99, 0.5])));
        renderer.addValue("No", new esri.symbol.SimpleFillSymbol().setColor(new dojo.Color([145, 176, 147, 0.5])));
        renderer.addValue("Don't Know", new esri.symbol.SimpleFillSymbol().setColor(new dojo.Color([202, 204, 153, 0.5])));
        gangLayer.setRenderer(renderer);
        map.addLayer(gangLayer);
        gLayer = new esri.layers.GraphicsLayer();
        map.addLayer(gLayer);
        var resizeTimer;
        dojo.connect(map, 'onLoad', function(theMap) {
            dojo.connect(dijit.byId("mapDiv"), 'resize', function() {
                //resize the map if the div is resized
                clearTimeout(resizeTimer);
                resizeTimer = setTimeout( function() {
                    map.resize();
                    map.reposition();
                    }, 500);
                });
		  	});
		dojo.connect(gangLayer, "onSelectionComplete", getGangInfo);
		dojo.connect(map, 'onClick', findGangs);
        var gangDialog = dijit.byId("dialogGang");
        dojo.connect(gangDialog, "onHide", clearTab);
		esriConfig.defaults.map.logoLink = "http://obeythekitty.blogspot.com";
		}
		function clearTab(){
		    dijit.byId("tabGangs").destroyDescendants();
		}
		dojo.addOnLoad(init);
    </script>
</html>